---
sort: 6
---
# 驱动开发

前面 3 篇，学习 Ubuntu 操作系统、学习 ARM 裸机、学习系统移植，为驱动开发做准备。

裸机驱动开发的特点：底层，和寄存器接触，有些 MCU 提供了库，但是仍然比较底层(相比 linux)。

linux 下直接操作寄存器不现实，跑 linux 的芯片性能都还不错，外设相当复杂，如果直接去看手册，那还是挺复杂的。imx6ull 是应用处理器里比较低端的芯片。

因此 linux 下的驱动开发的思维是框架，根据各种 Linux 下的**驱动框架**进行开发。
- linux 驱动开发 ≈ 各种驱动框架的掌握。
- 驱动最终表现为 /dev/xxx 文件。应用文件 open/close/write/read
- 新内核支持设备树，.dts 文件描述了板上的设备信息。因此第一件事要去在设备树上添加设备


Linux 中的三大类驱动：
- 字符设备驱动
  - 最多，最繁杂
  - 如 IIC，
- 块设备驱动
  - 按照固定大小读写
  - EMMC，SD card，SSD
- 网络设备驱动


USB 无线网卡 是什么类型的设备呢？两个属性都有。


驱动获取外设数据，控制外设，把数据给应用程序。linux 驱动开发不经要开发一个驱动，还要写一个简单的测试程序。MCU 开发中整个驱动和应用混杂在一起。

linux 下驱动和应用完全分开，操作系统内核和驱动运行在内核空间，应用程序运行在用户空间。应用程序想访问内核资源，三种方法：系统调用、异常(中断)和陷入(软中断)。

应用程序使用系统调用进入内核。

